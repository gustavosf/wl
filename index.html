<!doctype html>
<html>
<head>
  <title>Musculação</title>
  
  <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->

  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta charset="utf-8">
  <meta name="format-detection" content="telephone=no" />
  <meta name="msapplication-tap-highlight" content="no" />

  <script src="bower_components/platform/platform.js"></script>
  <script src="bower_components/jquery/dist/jquery.min.js"></script>
  <script src="bower_components/handlebars/handlebars.min.js"></script>

  <link rel="stylesheet" href="style.css">
 
  <link rel="import" href="bower_components/core-scaffold/core-scaffold.html">
  <link rel="import" href="bower_components/core-header-panel/core-header-panel.html">
  <link rel="import" href="bower_components/core-menu/core-menu.html">
  <link rel="import" href="bower_components/core-item/core-item.html">
  <link rel="import" href="bower_components/polymer-ui-card/polymer-ui-card.html">
  <link rel="import" href="bower_components/paper-tabs/paper-tabs.html">
</head>

<body unresolved>

  <core-scaffold>
  
    <core-header-panel navigation flex mode="seamed">
      <core-toolbar style="background-color: #526E9C; color: #fff;">Grupos</core-toolbar>
      <core-menu id="menu">
        <core-item icon="settings" refer="agenda.html" label="Agenda"></core-item>
        <core-item icon="settings" refer="exercises.html" group="A" label="A) Costas + Peito"></core-item>
        <core-item icon="settings" refer="exercises.html" group="B" label="B) Ombro + Trapésio"></core-item>
        <core-item icon="settings" refer="exercises.html" group="C" label="C) Tríceps + Biceps"></core-item>
        <core-item icon="settings" refer="exercises.html" serie="0" label="Sessão 1"></core-item>
        <core-item icon="settings" refer="exercises.html" serie="1" label="Sessão 2"></core-item>
      </core-menu>
    </core-header-panel>
    
    <div tool>Exercícios</div>
    
    <div class="content" id="content"></div>
  
  </core-scaffold>
  
  <script>
    $(document).ready(function () {
      // preload data
      var exercises = $.ajax({url: 'data/exercises.json', async: false, dataType: 'json'}).responseJSON;
      var sessions = $.ajax({url: 'data/sessions.json', async: false, dataType: 'json'}).responseJSON;

      $("#menu core-item").each(function (i, el) {
        $(el).click(function () {
          var grupo = $(this).attr('group'),
              serie = $(this).attr('serie'),
              list = $.grep(exercises, function (e) {
                if (serie) {
                  for (i in sessions[serie]) if (sessions[serie].hasOwnProperty(i)) {
                    if (e.nome == sessions[serie][i][1] && e.classe == sessions[serie][i][0])
                      return true;
                  }
                  return false;
                }
                return grupo != undefined && e.classe == grupo;
              });

          $.get($(this).attr('refer'), function (data) {
            $('#content').html(data);
            $(list).each(function (i, exercise) {
              var tmpl = Handlebars.compile($('#exercise-template').html());
              $(exercise.tipo == 'E' ? '#exercises' : '#stretches').append(tmpl(exercise));
            });

            $('#content .tab-content div:not(:first-child)').hide();
          });
        });
      });
 
      $('#content').delegate('paper-tab', 'click', function () {      
        $('#content .tab-content div').hide();
        $('#content .tab-content #' + $(this).attr('ref')).show();
      });
    });
</script>
</body>
</html>